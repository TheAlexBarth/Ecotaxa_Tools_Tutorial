{
  "hash": "a35f0e8e0b8835ea6ea2849c801c5c86",
  "result": {
    "markdown": "---\ntitle: Importing UVP Data From Ecopart Export\n---\n\n::: {.cell}\n\n:::\n\n\nThe first step to importing ecopart data is to guarantee that you exported the data correctly from ecopart. Follow those instructions [here]('./export_UVP_ecopart-export.html).\n\nThe next step is to import your into R for analysis.\n\nThe exported files should all be in a single directory:\n<img src=\"./media/UVP_Ecopart-Import_Image02_BV-files.png\" caption='Example of exported files from ecopart'/>\n\nFor this tutorial, I provided data in the package from AE1917. This is intended for examples only and not for research use. This data is stored as `ecopart_example` and is available throught the package\n\n### Importing the data:\n\n1.  Using the r function `ecopart_import()` assign the one argument of a path to the directory of your files\n\n2.  Assign the files to a list object. By using `ecopart_import()`, the imported files will be an `ecopart_obj` class structure. \\n\n    This class structure is defined by having three elements; (1) a `par_list` which has multiple `par_df` files; (2) a `zoo_list` which has multiple `zoo_df` files\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndir_path <- system.file('extdata','ae1917_example-data', \n                       package = 'EcotaxaTools') #This should be your directory location\necopart_list <- ecopart_import(dir_path) #load files\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in names(par_files) != names(zoo_files): longer object length is not a\nmultiple of shorter object length\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in ecopart_import(dir_path): The par_files and zoo_files don't exactly\nmatch\n```\n:::\n:::\n\n\n3.  This will create a three element list which can be used in analysis built into EcotaxaTools. This object is an `ecopart_obj` class. Review the class system [here](./info_uvp_general-layout.html)\n    1.  \"par_files\" - a list of tibbles with each particle file\n\n    2.  \"zoo_files\" - a list of tibbles with each plankton image file (classic tsv)\n\n    3.  \"meta\" - a tibble with the meta\n\n### Understanding the ecopart file list\n\nIf you are new to working with lists, it's worth [reading](https://adv-r.hadley.nz/names-values.html#list-references) a bit about them. While lists can be clunky, it allows for looping over large amounts of data stored in memory.\n\nBelow, I'll briefly show how to interact with some of the data stored in the ecopart list\n\n#### Looking at zooplankton data\n\nZooplankton data are stored in tibbles in the list \"zoo_files\". You can access elements of a list using the `$` operator or by indexing the 'bare' elements with `[[` index operator. The names of the zoo_files correspond to the particular casts of a project.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#all below with index the names files\nnames(ecopart_list$zoo_files)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"bats361_ctd1\"  \"bats361_ctd2\"  \"bats361_ctd3\"  \"bats361_ctd4\" \n [5] \"bats361_ctd5\"  \"bats361_ctd6\"  \"bats361_ctd7\"  \"bats361_ctd8\" \n [9] \"bats361_ctd9\"  \"bats361_ctd12\" \"bats361_ctd13\" \"bats361_ctd14\"\n[13] \"bats361_ctd15\" \"bats361_ctd16\" \"bats361_ctd17\" \"bats361_ctd19\"\n[17] \"bats361_ctd20\" \"bats361_ctd21\" \"bats361_ctd22\" \"bats361_ctd23\"\n[21] \"bats361_ctd24\" \"bats361_ctd25\" \"bats361_ctd26\" \"bats361_ctd27\"\n```\n:::\n\n```{.r .cell-code}\nnames(ecopart_list[[\"zoo_files\"]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"bats361_ctd1\"  \"bats361_ctd2\"  \"bats361_ctd3\"  \"bats361_ctd4\" \n [5] \"bats361_ctd5\"  \"bats361_ctd6\"  \"bats361_ctd7\"  \"bats361_ctd8\" \n [9] \"bats361_ctd9\"  \"bats361_ctd12\" \"bats361_ctd13\" \"bats361_ctd14\"\n[13] \"bats361_ctd15\" \"bats361_ctd16\" \"bats361_ctd17\" \"bats361_ctd19\"\n[17] \"bats361_ctd20\" \"bats361_ctd21\" \"bats361_ctd22\" \"bats361_ctd23\"\n[21] \"bats361_ctd24\" \"bats361_ctd25\" \"bats361_ctd26\" \"bats361_ctd27\"\n```\n:::\n\n```{.r .cell-code}\nnames(ecopart_list[[2]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"bats361_ctd1\"  \"bats361_ctd2\"  \"bats361_ctd3\"  \"bats361_ctd4\" \n [5] \"bats361_ctd5\"  \"bats361_ctd6\"  \"bats361_ctd7\"  \"bats361_ctd8\" \n [9] \"bats361_ctd9\"  \"bats361_ctd12\" \"bats361_ctd13\" \"bats361_ctd14\"\n[13] \"bats361_ctd15\" \"bats361_ctd16\" \"bats361_ctd17\" \"bats361_ctd19\"\n[17] \"bats361_ctd20\" \"bats361_ctd21\" \"bats361_ctd22\" \"bats361_ctd23\"\n[21] \"bats361_ctd24\" \"bats361_ctd25\" \"bats361_ctd26\" \"bats361_ctd27\"\n```\n:::\n:::\n\n\nEach zooplankton tibble has data from all vignettes collected from an individual uvp cast. You can access these in multiple ways with either the `$` operator or `[[` operators. These are very similar to the export data from standard Ecotaxa .tsv files. However, in an `ecopart_obj`, the metadata is stored separated (in the `meta` file). Not to worry, most EcotaxaTools functions will handle the metadata independently!\n\n\n::: {.cell}\n\n```{.r .cell-code}\necopart_list$zoo_files[[3]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 626 × 90\n   orig_id    objid name  taxo_hierarchy classif_qual depth_including… psampleid\n   <chr>      <dbl> <chr> <chr>          <chr>                   <dbl>     <dbl>\n 1 bats361_… 1.46e8 detr… not-living>de… V                       619.      33981\n 2 bats361_… 1.46e8 Aulo… living>Eukary… V                       379.      33981\n 3 bats361_… 1.46e8 badf… not-living>ar… V                        54.1     33981\n 4 bats361_… 1.46e8 Aulo… living>Eukary… V                       420.      33981\n 5 bats361_… 1.46e8 tuff  living>Bacter… V                       104.      33981\n 6 bats361_… 1.46e8 fibe… not-living>de… V                       124.      33981\n 7 bats361_… 1.46e8 detr… not-living>de… V                       117.      33981\n 8 bats361_… 1.46e8 badf… not-living>ar… V                       115.      33981\n 9 bats361_… 1.46e8 Aula… living>Eukary… V                       543.      33981\n10 bats361_… 1.46e8 detr… not-living>de… V                       282.      33981\n# … with 616 more rows, and 83 more variables: `%area` <dbl>, angle <dbl>,\n#   area <dbl>, area_exc <dbl>, areai <dbl>, bx <dbl>, by <dbl>, cdexc <dbl>,\n#   centroids <dbl>, circ. <dbl>, circex <dbl>, compentropy <dbl>,\n#   compm1 <dbl>, compm2 <dbl>, compm3 <dbl>, compmean <dbl>, compslope <dbl>,\n#   convarea <dbl>, convarea_area <dbl>, convperim <dbl>,\n#   convperim_perim <dbl>, cv <dbl>, elongation <dbl>, esd <dbl>, fcons <dbl>,\n#   feret <dbl>, feretareaexc <dbl>, fractal <dbl>, height <dbl>, …\n```\n:::\n:::\n\n\n#### Looking at particle data\n\nParticle data are stored in `par_df` tibbles for each cast. For a project, they will all be stored in the `par_files` element of the `ecopart_obj` list. Similar to the `zoo_files`, the names of the `par_files` correspond to the individual casts.\n\nA single `par_df` has 7 columns. The data here are presented in 1-m aggregate bins. Each row then is a 1-m depth bin with information about a single particle size class. Here are columns explained in detail:\n- The 'depth' column indicates the depth bin\n- The 'imgcount' column is the number of images taken in that depth bin (this is needed for volume sampled calculations)\n- The 'area' column indicates particle size as area of pixels\n- The 'nbr' column indicates the number of particles in that depth bin of that size class\n- The three greylimit columns correspond to the mean grey values of those particles. \n\n::: {.cell}\n\n```{.r .cell-code}\necopart_list$par_files[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 17,385 × 7\n   depth imgcount  area   nbr greylimit1 greylimit2 greylimit3\n   <dbl>    <dbl> <dbl> <dbl>      <dbl>      <dbl>      <dbl>\n 1     3       70    26    31          9         22         41\n 2     3       70    22    46         12         25         44\n 3     3       70    21    54         11         17         31\n 4     3       70    17    94         12         22         40\n 5     3       70    16   104         13         23         36\n 6     3       70    15   139         12         23         32\n 7     3       70    14   154         12         23         35\n 8     3       70    13   218         11         18         29\n 9     3       70    12   309         11         19         29\n10     3       70    11   375         12         19         30\n# … with 17,375 more rows\n```\n:::\n:::\n\n\n\nLearn more about how to process particle concentration data [here](./uvp_par-concentration.html)",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}